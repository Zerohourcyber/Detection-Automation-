title: SSH Brute Force Attack Detection
id: 4624d47e-b9c2-4d48-a0c7-9e8f1a2b3c4d
status: stable
description: Detects SSH brute force attacks based on multiple failed authentication attempts from the same source IP
author: Detection Lab Team
date: 2024/01/01
modified: 2024/01/01
tags:
    - attack.credential_access
    - attack.t1110.001
    - attack.brute_force
logsource:
    product: linux
    service: sshd
    category: authentication
detection:
    ssh_failed_login:
        - EventID: 4625  # Windows equivalent
        - failed|contains: 'authentication failure'
        - failed|contains: 'Failed password'
        - failed|contains: 'Invalid user'
        - failed|contains: 'Connection closed by authenticating user'
    ssh_success_login:
        - EventID: 4624  # Windows equivalent  
        - success|contains: 'Accepted password'
        - success|contains: 'Accepted publickey'
        - success|contains: 'session opened'
    filter_localhost:
        src_ip: '127.0.0.1'
    condition: ssh_failed_login and not filter_localhost
    # Correlation rules for brute force detection
    timeframe: 2m
    count: 5
    group_by: src_ip
falsepositives:
    - Legitimate user with forgotten password
    - Misconfigured SSH clients
    - Network connectivity issues
    - Automated backup systems with wrong credentials
level: high
fields:
    - src_ip
    - user
    - timestamp
    - process_name
    - command_line
---
title: SSH Brute Force - High Volume Attack
id: 5735e58f-c0d3-4e59-b1d8-0f9g2b3c4e5f
status: stable
description: Detects high-volume SSH brute force attacks (10+ failed attempts in 5 minutes)
author: Detection Lab Team
date: 2024/01/01
modified: 2024/01/01
tags:
    - attack.credential_access
    - attack.t1110.001
    - attack.brute_force
logsource:
    product: linux
    service: sshd
    category: authentication
detection:
    ssh_failed_login:
        - failed|contains: 'authentication failure'
        - failed|contains: 'Failed password'
        - failed|contains: 'Invalid user'
    filter_localhost:
        src_ip: '127.0.0.1'
    condition: ssh_failed_login and not filter_localhost
    timeframe: 5m
    count: 10
    group_by: src_ip
falsepositives:
    - Legitimate user with multiple failed attempts
    - Misconfigured automated systems
level: critical
fields:
    - src_ip
    - user
    - timestamp
    - failed_attempts_count
---
title: SSH Brute Force - Multiple Users Targeted
id: 6846f69g-d1e4-4f60-c2e9-1g0h3c4d5f6g
status: stable
description: Detects SSH brute force attacks targeting multiple user accounts from the same source
author: Detection Lab Team
date: 2024/01/01
modified: 2024/01/01
tags:
    - attack.credential_access
    - attack.t1110.001
    - attack.brute_force
    - attack.discovery
    - attack.t1087
logsource:
    product: linux
    service: sshd
    category: authentication
detection:
    ssh_failed_login:
        - failed|contains: 'authentication failure'
        - failed|contains: 'Failed password'
        - failed|contains: 'Invalid user'
    filter_localhost:
        src_ip: '127.0.0.1'
    condition: ssh_failed_login and not filter_localhost
    timeframe: 3m
    count: 8
    group_by: src_ip
    unique_count: user
    unique_threshold: 3
falsepositives:
    - System administrators testing multiple accounts
    - Automated deployment scripts with wrong credentials
level: high
fields:
    - src_ip
    - user
    - timestamp
    - unique_users_targeted
---
title: SSH Root Login Brute Force
id: 7957g70h-e2f5-5g71-d3fa-2h1i4d5e6g7h
status: stable
description: Detects brute force attacks specifically targeting the root user account
author: Detection Lab Team
date: 2024/01/01
modified: 2024/01/01
tags:
    - attack.credential_access
    - attack.t1110.001
    - attack.privilege_escalation
    - attack.t1078.003
logsource:
    product: linux
    service: sshd
    category: authentication
detection:
    ssh_root_failed:
        - failed|contains: 'authentication failure'
        - failed|contains: 'Failed password'
        - user: 'root'
    filter_localhost:
        src_ip: '127.0.0.1'
    condition: ssh_root_failed and not filter_localhost
    timeframe: 2m
    count: 3
    group_by: src_ip
falsepositives:
    - Legitimate root user with forgotten password
    - Misconfigured root access scripts
level: high
fields:
    - src_ip
    - user
    - timestamp
    - authentication_method
---
title: SSH Successful Login After Brute Force
id: 8068h81i-f3g6-6h82-e4gb-3i2j5e6f7h8i
status: stable
description: Detects successful SSH login after previous failed attempts, indicating potential compromise
author: Detection Lab Team
date: 2024/01/01
modified: 2024/01/01
tags:
    - attack.credential_access
    - attack.t1110.001
    - attack.initial_access
    - attack.t1078
logsource:
    product: linux
    service: sshd
    category: authentication
detection:
    ssh_success:
        - success|contains: 'Accepted password'
        - success|contains: 'Accepted publickey'
        - success|contains: 'session opened'
    ssh_previous_failures:
        - failed|contains: 'authentication failure'
        - failed|contains: 'Failed password'
    filter_localhost:
        src_ip: '127.0.0.1'
    condition: ssh_success and not filter_localhost
    # This requires correlation with previous failed attempts from same IP
    correlation:
        type: temporal
        rules:
            - ssh_previous_failures
        timeframe: 10m
        group_by: src_ip
falsepositives:
    - Legitimate user after typos or forgotten password
    - User changing passwords
level: medium
fields:
    - src_ip
    - user
    - timestamp
    - authentication_method
    - session_id
---
title: SSH Connection from Blacklisted IP
id: 9179i92j-g4h7-7i93-f5hc-4j3k6f7g8i9j
status: stable
description: Detects SSH connection attempts from known malicious or blacklisted IP addresses
author: Detection Lab Team
date: 2024/01/01
modified: 2024/01/01
tags:
    - attack.credential_access
    - attack.t1110.001
    - attack.initial_access
    - attack.t1190
logsource:
    product: linux
    service: sshd
    category: authentication
detection:
    ssh_connection:
        - EventID: 4624
        - EventID: 4625
        - contains: 'connection from'
        - contains: 'authentication'
    blacklisted_ips:
        src_ip|contains:
            # Threat intelligence feeds should populate this
            - '192.168.100.100'  # Example malicious IP
            - '10.0.0.100'       # Example compromised internal IP
    condition: ssh_connection and blacklisted_ips
falsepositives:
    - False positive in threat intelligence feeds
    - Recently cleaned/remediated systems
level: critical
fields:
    - src_ip
    - user
    - timestamp
    - threat_intel_source
    - blacklist_reason